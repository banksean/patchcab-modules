import{usePan as t,scale as e,round as n,Label as s,Faceplate as _,Patch as a}from"/js/core.js";function o(t){let e,n;return{c(){e=__sv.element("div"),n=__sv.text(t[2]),__sv.attr(e,"class","label svelte-byng8")},m(t,s){__sv.insert(t,e,s),__sv.append(e,n)},p(t,e){4&e&&__sv.set_data(n,t[2])},d(t){t&&__sv.detach(e)}}}function l(e){let n,s,_,a,l,i,r,v,p,c=e[2]&&o(e);return{c(){n=__sv.element("div"),s=__sv.svg_element("svg"),_=__sv.svg_element("g"),a=__sv.svg_element("rect"),l=__sv.svg_element("rect"),r=__sv.space(),c&&c.c(),__sv.set_style(a,"fill","#ddd"),__sv.attr(a,"x","50%"),__sv.attr(a,"y","0"),__sv.attr(a,"width","3"),__sv.attr(a,"height","100%"),__sv.set_style(l,"fill","#eee"),__sv.attr(l,"x","0"),__sv.attr(l,"y",i=e[3]+"px"),__sv.attr(l,"width","100%"),__sv.attr(l,"height","8"),__sv.attr(s,"width","32"),__sv.attr(s,"height","200"),__sv.attr(s,"fill","red"),__sv.attr(s,"xmlns","http://www.w3.org/2000/svg"),__sv.attr(s,"class","svelte-byng8"),__sv.attr(n,"class","container svelte-byng8"),__sv.set_style(n,"left",e[0]+"px"),__sv.set_style(n,"top",e[1]+"px")},m(o,i){__sv.insert(o,n,i),__sv.append(n,s),__sv.append(s,_),__sv.append(_,a),__sv.append(_,l),__sv.append(n,r),c&&c.m(n,null),v||(p=__sv.action_destroyer(t.call(null,n,e[4])),v=!0)},p(t,[e]){8&e&&i!==(i=t[3]+"px")&&__sv.attr(l,"y",i),t[2]?c?c.p(t,e):(c=o(t),c.c(),c.m(n,null)):c&&(c.d(1),c=null),1&e&&__sv.set_style(n,"left",t[0]+"px"),2&e&&__sv.set_style(n,"top",t[1]+"px")},i:__sv.noop,o:__sv.noop,d(t){t&&__sv.detach(n),c&&c.d(),v=!1,p()}}}function i(t,s,_){let a,{x:o}=s,{y:l}=s,{min:i}=s,{max:r}=s,{value:v}=s,{label:p}=s,{steps:c=200}=s,{precision:m=0}=s;return t.$$set=t=>{"x"in t&&_(0,o=t.x),"y"in t&&_(1,l=t.y),"min"in t&&_(6,i=t.min),"max"in t&&_(7,r=t.max),"value"in t&&_(5,v=t.value),"label"in t&&_(2,p=t.label),"steps"in t&&_(8,c=t.steps),"precision"in t&&_(9,m=t.precision)},t.$$.update=()=>{224&t.$$.dirty&&_(3,a=e(v,[i,r],[190,5],0))},[o,l,p,a,({dy:t})=>{if(0!==t){const e=n(v-t*((r-i)/c),m);_(5,v=Math.max(Math.min(e,r),i))}},v,i,r,c,m]}class r extends __sv.SvelteComponent{constructor(t){var e;super(),document.getElementById("svelte-byng8-style")||((e=__sv.element("style")).id="svelte-byng8-style",e.textContent=".container.svelte-byng8{display:block;position:absolute;width:32px;height:228px;cursor:row-resize}svg.svelte-byng8{position:absolute;top:0px;left:0px;transform-origin:center}.label.svelte-byng8{position:absolute;bottom:0px;width:100%;margin-left:auto;margin-right:auto;font-size:small;text-align:center}",__sv.append(document.head,e)),__sv.init(this,t,i,l,__sv.safe_not_equal,{x:0,y:1,min:6,max:7,value:5,label:2,steps:8,precision:9})}}__sv.SvelteComponent;function v(t,e,n){const s=t.slice();return s[8]=e[n],s[9]=e,s[10]=n,s}function p(t){let e,n,s,_,o;function l(e){t[6](e,t[10])}let i={y:10,x:48*(t[10]+1),min:0,max:1,precision:2,label:"H"+(t[10]+1)};return void 0!==t[0].partials[t[10]]&&(i.value=t[0].partials[t[10]]),e=new r({props:i}),__sv.binding_callbacks.push((()=>__sv.bind(e,"value",l))),_=new a({props:{x:48*(t[10]+1)+8,y:250,name:"partial-"+t[10],input:t[3][t[10]]}}),{c(){__sv.create_component(e.$$.fragment),s=__sv.space(),__sv.create_component(_.$$.fragment)},m(t,n){__sv.mount_component(e,t,n),__sv.insert(t,s,n),__sv.mount_component(_,t,n),o=!0},p(s,_){t=s;const a={};!n&&1&_&&(n=!0,a.value=t[0].partials[t[10]],__sv.add_flush_callback((()=>n=!1))),e.$set(a)},i(t){o||(__sv.transition_in(e.$$.fragment,t),__sv.transition_in(_.$$.fragment,t),o=!0)},o(t){__sv.transition_out(e.$$.fragment,t),__sv.transition_out(_.$$.fragment,t),o=!1},d(t){__sv.destroy_component(e,t),t&&__sv.detach(s),__sv.destroy_component(_,t)}}}function c(t){let e,n,s,_,o,l,i,c,m;function $(e){t[5](e)}let y={y:10,x:0,min:d,max:f,steps:500,label:"f"};void 0!==t[0].fundamental&&(y.value=t[0].fundamental),n=new r({props:y}),__sv.binding_callbacks.push((()=>__sv.bind(n,"value",$)));let g=t[0].partials,h=[];for(let e=0;e<g.length;e+=1)h[e]=p(v(t,g,e));const x=t=>__sv.transition_out(h[t],1,1,(()=>{h[t]=null}));return l=new a({props:{x:28,y:290,name:"in-cv",input:t[2],onConnect:t[4]}}),c=new a({props:{label:"out",x:48*(u+1),y:330,name:"out-cv",output:t[1]}}),{c(){e=__sv.element("partials"),__sv.create_component(n.$$.fragment),_=__sv.space();for(let t=0;t<h.length;t+=1)h[t].c();o=__sv.space(),__sv.create_component(l.$$.fragment),i=__sv.space(),__sv.create_component(c.$$.fragment),__sv.attr(e,"class","svelte-wo81ky")},m(t,s){__sv.insert(t,e,s),__sv.mount_component(n,e,null),__sv.append(e,_);for(let t=0;t<h.length;t+=1)h[t].m(e,null);__sv.insert(t,o,s),__sv.mount_component(l,t,s),__sv.insert(t,i,s),__sv.mount_component(c,t,s),m=!0},p(t,_){const a={};if(!s&&1&_&&(s=!0,a.value=t[0].fundamental,__sv.add_flush_callback((()=>s=!1))),n.$set(a),9&_){let n;for(g=t[0].partials,n=0;n<g.length;n+=1){const s=v(t,g,n);h[n]?(h[n].p(s,_),__sv.transition_in(h[n],1)):(h[n]=p(s),h[n].c(),__sv.transition_in(h[n],1),h[n].m(e,null))}for(__sv.group_outros(),n=g.length;n<h.length;n+=1)x(n);__sv.check_outros()}const o={};2&_&&(o.output=t[1]),c.$set(o)},i(t){if(!m){__sv.transition_in(n.$$.fragment,t);for(let t=0;t<g.length;t+=1)__sv.transition_in(h[t]);__sv.transition_in(l.$$.fragment,t),__sv.transition_in(c.$$.fragment,t),m=!0}},o(t){__sv.transition_out(n.$$.fragment,t),h=h.filter(Boolean);for(let t=0;t<h.length;t+=1)__sv.transition_out(h[t]);__sv.transition_out(l.$$.fragment,t),__sv.transition_out(c.$$.fragment,t),m=!1},d(t){t&&__sv.detach(e),__sv.destroy_component(n),__sv.destroy_each(h,t),t&&__sv.detach(o),__sv.destroy_component(l,t),t&&__sv.detach(i),__sv.destroy_component(c,t)}}}function m(t){let e,n;return e=new _({props:{title:"ADDITIVE OSC",color:"#1D1E22",$$slots:{default:[c]},$$scope:{ctx:t}}}),{c(){__sv.create_component(e.$$.fragment)},m(t,s){__sv.mount_component(e,t,s),n=!0},p(t,[n]){const s={};2051&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(__sv.transition_in(e.$$.fragment,t),n=!0)},o(t){__sv.transition_out(e.$$.fragment,t),n=!1},d(t){__sv.destroy_component(e,t)}}}const u=16,d=20,f=200;function $(t,e,n){let{state:s={partials:Array(u).fill(0).map((()=>Math.random())),fundamental:0}}=e;const _=new Tone.Oscillator(s.fundamental).start();_.partialCount=u;const a=new Tone.Signal,o=Array(u).fill(0).map((()=>new Tone.Scale(0,1)));return t.$$set=t=>{"state"in t&&n(0,s=t.state)},t.$$.update=()=>{1&t.$$.dirty&&n(1,_.frequency.value=s.fundamental,_),1&t.$$.dirty&&n(1,_.partials=[...s.partials.map(((t,e)=>t))],_)},n(1,_.type="custom",_),[s,_,a,o,t=>{t?a.connect(_.frequency):(a.disconnect(_.frequency),n(1,_.frequency.overridden=!1,_),n(1,_.frequency.value=s.fundamental,_))},function(e){t.$$.not_equal(s.fundamental,e)&&(s.fundamental=e,n(0,s))},function(e,_){t.$$.not_equal(s.partials[_],e)&&(s.partials[_]=e,n(0,s))}]}class y extends __sv.SvelteComponent{constructor(t){var e;super(),document.getElementById("svelte-wo81ky-style")||((e=__sv.element("style")).id="svelte-wo81ky-style",e.textContent="partials.svelte-wo81ky{position:absolute;top:40px;left:20px}",__sv.append(document.head,e)),__sv.init(this,t,$,m,__sv.safe_not_equal,{state:0})}}export default y;
